<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- (แก้ไข) อัปเดต Title ตามไฟล์ของคุณ -->
<title>SawangHos IPD Nurse Workbench</title>

<script src="https://cdn.tailwindcss.com"></script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  /* ตั้งค่า Font หลัก */
  body {
    font-family: 'Sarabun', sans-serif;
  }
  /* คลาสสำหรับซ่อน/แสดง */
  .hidden {
    display: none;
  }
</style>
</head>

<body class="bg-gray-100">

<nav class="bg-white shadow-md fixed top-0 left-0 right-0 z-40">
  <div class="container mx-auto px-4 py-3">
    <div class="flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <img src="https://swdcph.moph.go.th/intranet/login/images/logo_swd.png" alt="Logo" class="h-12 w-12">
        <div>
          <h1 class="text-xl font-bold text-gray-800">IPD Nurse Workbench</h1>
          <div id="realtime-clock" class="text-xs text-gray-500"></div>
        </div>
      </div>
      
      <div class="md:hidden">
      </div>
    </div>
  </div>
</nav>

<!-- (สำคัญ!) แท็ก <main> จะคลุมทุกอย่างไว้ -->
<main class="mt-24 pt-4 container mx-auto px-4">

  <!-- (1) หน้าเลือก Ward -->
  <section id="ward-selection" class="animate-fade-in">
    <h2 class="text-2xl font-semibold text-gray-700 mb-6 text-center">กรุณาเลือกตึกที่ต้องการใช้งาน</h2>
    <div id="ward-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    </div>
  </section>

  <!-- (2) หน้าทะเบียนผู้ป่วย -->
  <section id="registry-page" class="hidden animate-fade-in">
    
    <div class="bg-white p-4 rounded-lg shadow mb-6">
      <div class="flex flex-col md:flex-row justify-between md:items-center gap-4">
        <div>
          <h2 class="text-2xl font-bold text-blue-700" id="ward-header-title"></h2>
          <select id="ward-switcher" class="mt-1 p-2 border rounded-md">
          </select>
        </div>
        
        <div>
          <button id="open-admit-modal-btn" class="w-full md:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-colors">
            + Admit ผู้ป่วยใหม่
          </button>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mt-4 border-t pt-4">
        <input type="text" id="search-hn" placeholder="ค้นหา HN" class="p-2 border rounded-md">
        <input type="text" id="search-an" placeholder="ค้นหา AN" class="p-2 border rounded-md">
        <input type="text" id="search-name" placeholder="ค้นหา ชื่อ-สกุล" class="p-2 border rounded-md">
        <input type="text" id="search-doctor" placeholder="ค้นหา แพทย์" class="p-2 border rounded-md">
      </div>
    </div>

    <div class="bg-white rounded-lg shadow overflow-x-auto">
      <table class="w-full min-w-max">
        <thead class="bg-gray-200 text-gray-700">
          <tr>
            <th class="p-3 text-left">เตียง</th>
            <th class="p-3 text-left">HN</th>
            <th class="p-3 text-left">AN</th>
            <th class="p-3 text-left">ชื่อ-สกุล ผู้ป่วย</th>
            <th class="p-3 text-left">อายุ (ปี/ด/ว)</th>
            <th class="p-3 text-left">แผนก</th>
            <th class="p-3 text-left">แพทย์</th>
            <th class="p-3 text-left">วันที่ Admit</th>
            <th class="p-3 text-left">วันนอน (LOS)</th>
            <th class="p-3 text-left">Chart</th>
          </tr>
        </thead>
        <tbody id="patient-table-body" class="divide-y divide-gray-200">
        </tbody>
      </table>
    </div>
  </section>

  <!-- (3) หน้า Chart (เวชระเบียน) -->
  <section id="chart-page" class="hidden animate-fade-in">

    <div class="bg-white p-4 rounded-lg shadow mb-6 flex justify-between items-center">
      <div>
        <h2 class="text-2xl font-bold text-indigo-700">เวชระเบียนผู้ป่วยงานการพยาบาลผู้ป่วยใน (Patient Chart)</h2>
        <p class="text-gray-600">AN: <strong id="chart-an-display"></strong> | HN: <strong id="chart-hn-display"></strong> | ชื่อ: <strong id="chart-name-display"></strong></p>
      </div>
      <button id="close-chart-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg">
        &larr; กลับหน้าทะเบียน
      </button>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      
      <!-- (3.1) เมนูฟอร์ม (ซ้าย) -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-lg shadow overflow-hidden">
          <ul class="divide-y divide-gray-200">
            
            <li class="p-4 hover:bg-gray-50 flex justify-between items-center cursor-pointer chart-list-item" data-form="classify">
              <div>
                <h3 class="text-lg font-semibold text-gray-900">แบบบันทึกการการจำแนกประเภทผู้ป่วย</h3>
                <p class="text-sm text-gray-500">บันทึกรายเวร</p>
              </div>
              <div class="text-right">
                <span class="text-sm text-gray-600">อัปเดต: <span id="last-updated-classify">ยังไม่เคยบันทึก</span></span>
                <span class="text-blue-600 font-semibold ml-4">&gt;</span>
              </div>
            </li>
            
            <li class="p-4 hover:bg-gray-50 flex justify-between items-center cursor-pointer chart-list-item" data-form="004">
              <div>
                <h3 class="text-lg font-semibold text-gray-900">แบบประเมินประวัติและสมรรถนะผู้ป่วยใน</h3>
                <p class="text-sm text-gray-500">FR-IPD-004</p>
              </div>
              <div class="text-right">
                <span class="text-sm text-gray-600">อัปเดต: <span id="last-updated-004">ยังไม่เคยบันทึก</span></span>
                <span class="text-blue-600 font-semibold ml-4">&gt;</span>
              </div>
            </li>

            <li class="p-4 hover:bg-gray-50 flex justify-between items-center cursor-pointer chart-list-item" data-form="005">
              <div>
                <h3 class="text-lg font-semibold text-gray-900">รายการปัญหาสุขภาพ (FOCUS LIST)</h3>
                <p class="text-sm text-gray-500">FR-IPD-005</p>
              </div>
              <div class="text-right">
                <span class="text-sm text-gray-600">อัปเดต: <span id="last-updated-005">ยังไม่เคยบันทึก</span></span>
                <span class="text-blue-600 font-semibold ml-4">&gt;</span>
              </div>
            </li>
            
          </ul>
        </div>
      </div>
      
      <!-- (3.2) หน้าพรีวิว (ขวา) -->
      <div class="lg:col-span-2">
        <div class="bg-white rounded-lg shadow sticky top-24"> 
          <div class="p-4 border-b flex justify-between items-center">
            <h3 id="chart-preview-title" class="text-xl font-semibold text-indigo-700">เลือกเอกสาร</h3>
            <div>
              <button id="chart-add-new-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg mr-2 hidden">
                + เพิ่มใหม่
              </button>
              <button id="chart-edit-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hidden">
                 แก้ไข
              </button>
            </div>
          </div>
          
          <div id="chart-preview-wrapper" class="overflow-y-auto" style="max-height: 75vh;">
            <!-- (Placeholder เริ่มต้น) -->
            <div id="chart-preview-placeholder" class="text-center text-gray-500 py-20 px-6">
              <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
              <h3 class="mt-2 text-lg font-semibold text-gray-700">กรุณาเลือกรายการเอกสาร</h3>
              <p class="mt-1 text-sm text-gray-500">คลิกรายการด้านซ้ายเพื่อดูตัวอย่าง (Read-only) หรือกด "แก้ไข"</p>
            </div>
            
            <!-- (เนื้อหาพรีวิวจะถูกฉีดมาที่นี่) -->
            <div id="chart-preview-content" class="p-6"></div>
          </div>
        </div>
      </div>
      
    </div>
  </section> <!-- (ปิด section 'chart-page') -->

  <!-- ============================================= -->
  <!-- (4) TEMPLATES (สำหรับ Clone) -->
  <!-- ============================================= -->

  <!-- (Template 004) -->
  <template id="preview-template-004">
      <div class="space-y-6">
        <style>
          .preview-grid { display: grid; grid-template-columns: repeat(1, 1fr); gap: 1rem; }
          @media (min-width: 768px) { .preview-grid { grid-template-columns: repeat(3, 1fr); } }
          .preview-grid dt { font-size: 0.875rem; font-weight: 600; color: #4B5563; }
          .preview-grid dd { font-size: 1rem; color: #1F2937; min-height: 1.5rem; border-bottom: 1px dashed #D1D5DB; padding-bottom: 2px; }
          .preview-grid .col-span-full { grid-column: 1 / -1; }
          .preview-grid-2 { grid-template-columns: repeat(2, 1fr); }
          .preview-grid-4 { grid-template-columns: repeat(4, 1fr); }
        </style>
        
        <!-- ข้อมูลทั่วไป -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">ข้อมูลทั่วไป</legend>
          <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-2 preview-grid">
            <div><dt>วันที่รับ:</dt><dd data-field="AdmitDate"></dd></div>
            <div><dt>เวลารับ:</dt><dd data-field="AdmitTime"></dd></div>
            <div><dt>รับจาก:</dt><dd data-field="AdmittedFrom"></dd></div>
            <div><dt>Refer จาก:</dt><dd data-field="Refer"></dd></div>
            <div><dt>มาโดย:</dt><dd data-field="ArriveBy"></dd></div>
            <div><dt>ผู้ให้ข้อมูล:</dt><dd data-field="InfoSource"></dd></div>
            <div class="md:col-span-2"><dt>ผู้ดูแลหลัก:</dt><dd data-field="MainCaregiver_Name"></dd></div>
            <div class="md:col-span-2"><dt>ความสัมพันธ์:</dt><dd data-field="MainCaregiver_Rel"></dd></div>
            <div class="col-span-full"><dt>อาการสำคัญ (CC):</dt><dd data-field="ChiefComplaint"></dd></div>
            <div class="col-span-full"><dt>ประวัติปัจจุบัน (PI):</dt><dd data-field="PresentIllness"></dd></div>
            <div class="col-span-full"><dt>อาการแรกรับ:</dt><dd data-field="AdmitSymptoms"></dd></div>
            <div><dt>BT:</dt><dd data-field="Admit_BT"></dd></div>
            <div><dt>PR:</dt><dd data-field="Admit_PR"></dd></div>
            <div><dt>RR:</dt><dd data-field="Admit_RR"></dd></div>
            <div><dt>BP:</dt><dd data-field="Admit_BP"></dd></div>
          </div>
        </fieldset>
        
        <!-- ประวัติ (Hx) -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">ประวัติการเจ็บป่วย (History)</legend>
          <div class="preview-grid mt-2">
            <div><dt>โรคประจำตัว:</dt><dd data-field="Hx_Status"></dd></div>
            <div class="col-span-full"><dt>รายละเอียดโรค:</dt><dd id="preview-hx-details"></dd></div>
            <div><dt>การแพ้ยา:</dt><dd data-field="Allergy_Status"></dd></div>
            <div class="col-span-full"><dt>รายละเอียดการแพ้:</dt><dd data-field="Allergy_Details"></dd></div>
            <div><dt>การผ่าตัด:</dt><dd data-field="Sx_Status"></dd></div>
            <div class="md:col-span-2"><dt>รายละเอียดผ่าตัด:</dt><dd id="preview-sx-details"></dd></div>
            <div><dt>การนอน รพ.:</dt><dd data-field="AdmitHx_Status"></dd></div>
            <div class="md:col-span-2"><dt>รายละเอียดการนอน รพ.:</dt><dd id="preview-admit-hx-details"></dd></div>
            <div><dt>ประวัติครอบครัว:</dt><dd data-field="FamilyHx_Status"></dd></div>
            <div class="md:col-span-2"><dt>รายละเอียดประวัติครอบครัว:</dt><dd data-field="FamilyHx_Details"></dd></div>
            <div><dt>สุรา:</dt><dd data-field="Substance_Alcohol"></dd></div>
            <div class="md:col-span-2"><dt>ปริมาณสุรา:</dt><dd data-field="Substance_Alcohol_Vol"></dd></div>
            <div><dt>บุหรี่:</dt><dd data-field="Substance_Smoke"></dd></div>
            <div class="md:col-span-2"><dt>ปริมาณบุหรี่:</dt><dd data-field="Substance_Smoke_Vol"></dd></div>
            <div><dt>ยาที่ใช้ประจำ:</dt><dd data-field="Meds_Status"></dd></div>
            <div class="col-span-full"><dt>รายละเอียดยา:</dt><dd data-field="Meds_Details"></dd></div>
          </div>
        </fieldset>
        
        <!-- 1. การรับรู้สุขภาพ -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">1. การรับรู้สุขภาพ</legend>
          <div class="preview-grid mt-2">
            <div><dt>ก่อนป่วย:</dt><dd data-field="HP_Before"></dd></div>
            <div class="md:col-span-2"><dt>รายละเอียด (ก่อนป่วย):</dt><dd data-field="HP_Before_Detail"></dd></div>
            <div><dt>ครั้งนี้:</dt><dd data-field="HP_Current"></dd></div>
            <div><dt>การดูแล:</dt><dd data-field="HP_Care"></dd></div>
            <div class="md:col-span-2"><dt>ดูแล (อื่นๆ):</dt><dd data-field="HP_Care_Other"></dd></div>
            <div class="col-span-full"><dt>ความคาดหวัง:</dt><dd data-field="HP_Expect"></dd></div>
          </div>
        </fieldset>

        <!-- 2. โภชนาการ -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">2. โภชนาการ</legend>
          <div class="preview-grid mt-2">
            <div><dt>รับประทาน:</dt><dd data-field="Nutri_Meals"></dd></div>
            <div><dt>ประเภทอาหาร:</dt><dd data-field="Nutri_Type"></dd></div>
            <div><dt>อาหารเฉพาะโรค:</dt><dd data-field="Nutri_Type_Detail"></dd></div>
            <div><dt>ปัญหาการกิน:</dt><dd data-field="Nutri_Problem"></dd></div>
            <div><dt>ผิวหนัง:</dt><dd data-field="Nutri_Skin"></dd></div>
            <div class="md:col-span-2"><dt>ผิวหนัง (ระบุ):</dt><dd data-field="Nutri_Skin_Detail"></dd></div>
          </div>
        </fieldset>

        <!-- 3. การขับถ่าย -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">3. การขับถ่าย</legend>
          <div class="preview-grid mt-2">
            <div><dt>ปัสสาวะ (ครั้ง/วัน):</dt><dd data-field="Elim_Urine_Freq"></dd></div>
            <div><dt>สถานะปัสสาวะ:</dt><dd data-field="Elim_Urine_Status"></dd></div>
            <div><dt>ปัสสาวะ (ระบุ):</dt><dd data-field="Elim_Urine_Detail"></dd></div>
            <div><dt>อุจจาระ (ครั้ง/วัน):</dt><dd data-field="Elim_Bowel_Freq"></dd></div>
            <div><dt>สถานะอุจจาระ:</dt><dd data-field="Elim_Bowel_Status"></dd></div>
            <div><dt>อุจจาระ (ระบุ):</dt><dd data-field="Elim_Bowel_Detail"></dd></div>
            <div class="col-span-full"><dt>ขับถ่ายทางหน้าท้อง:</dt><dd data-field="Elim_Stoma"></dd></div>
          </div>
        </fieldset>

        <!-- 4. ADL -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">4. กิจวัตรประจำวัน (ADL)</legend>
          <div class="overflow-x-auto mt-2">
            <table class="w-full text-sm">
              <thead class="bg-gray-50">
                <tr class="text-left">
                  <th class="p-2 border">กิจกรรม</th>
                  <th class="p-2 border">ก่อนการเจ็บป่วย</th>
                  <th class="p-2 border">ขณะเจ็บป่วย</th>
                </tr>
              </thead>
              <tbody>
                <tr><td class="p-2 border">การรับประทานอาหาร</td><td class="p-2 border"><dd data-field="ADL_Eat_Before"></dd></td><td class="p-2 border"><dd data-field="ADL_Eat_Current"></dd></td></tr>
                <tr><td class="p-2 border">การทำความสะอาดปาก/ฟัน</td><td class="p-2 border"><dd data-field="ADL_Brush_Before"></dd></td><td class="p-2 border"><dd data-field="ADL_Brush_Current"></dd></td></tr>
                <tr><td class="p-2 border">การแต่งตัว</td><td class="p-2 border"><dd data-field="ADL_Dress_Before"></dd></td><td class="p-2 border"><dd data-field="ADL_Dress_Current"></dd></td></tr>
                <tr><td class="p-2 border">การเดิน</td><td class="p-2 border"><dd data-field="ADL_Walk_Before"></dd></td><td class="p-2 border"><dd data-field="ADL_Walk_Current"></dd></td></tr>
                <tr><td class="p-2 border">การขับถ่าย</td><td class="p-2 border"><dd data-field="ADL_Toilet_Before"></dd></td><td class="p-2 border"><dd data-field="ADL_Toilet_Current"></dd></td></tr>
                <tr><td class="p-2 border">การอาบน้ำ</td><td class="p-2 border"><dd data-field="ADL_Bath_Before"></dd></td><td class="p-2 border"><dd data-field="ADL_Bath_Current"></dd></td></tr>
              </tbody>
            </table>
          </div>
        </fieldset>
        
        <!-- 5. การพักผ่อน -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">5. การพักผ่อน</legend>
          <div class="preview-grid mt-2">
            <div><dt>ชั่วโมงนอน:</dt><dd data-field="Sleep_Hours"></dd></div>
            <div><dt>เพียงพอ:</dt><dd data-field="Sleep_Adequacy"></dd></div>
            <div><dt>ปัญหาการนอน:</dt><dd data-field="Sleep_Problem"></dd></div>
            <div class="col-span-full"><dt>ปัญหา (ระบุ):</dt><dd data-field="Sleep_Problem_Detail"></dd></div>
          </div>
        </fieldset>

        <!-- 6. การรับรู้ -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">6. การรับรู้และประสาทสัมผัส</legend>
          <div class="preview-grid mt-2">
            <div><dt>ระดับความรู้สึก:</dt><dd data-field="Cogn_LOC"></dd></div>
            <div><dt>การมองเห็น:</dt><dd data-field="Cogn_Vision"></dd></div>
            <div><dt>มองเห็น (อื่นๆ):</dt><dd data-field="Cogn_Vision_Other"></dd></div>
            <div><dt>การได้ยิน:</dt><dd data-field="Cogn_Hearing"></dd></div>
            <div><dt>ได้ยิน (อื่นๆ):</dt><dd data-field="Cogn_Hearing_Other"></dd></div>
            <div><dt>การพูด:</dt><dd data-field="Cogn_Speech"></dd></div>
            <div class="md:col-span-2"><dt>พูด (ภาษา):</dt><dd data-field="Cogn_Speech_Other"></dd></div>
            <div><dt>การเคลื่อนไหว:</dt><dd data-field="Cogn_Movement"></dd></div>
            <div class="md:col-span-2"><dt>เคลื่อนไหว (อื่นๆ):</dt><dd data-field="Cogn_Movement_Other"></dd></div>
          </div>
        </fieldset>
        
        <!-- 7. การรับรู้ตนเอง -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">7. การรับรู้ตนเอง</legend>
          <div class="preview-grid mt-2">
            <div><dt>กระทบภาพลักษณ์:</dt><dd data-field="Self_Image"></dd></div>
            <div class="md:col-span-2"><dt>ภาพลักษณ์ (ระบุ):</dt><dd data-field="Self_Image_Detail"></dd></div>
            <div><dt>กระทบอารมณ์:</dt><dd data-field="Self_Mood"></dd></div>
            <div class="md:col-span-2"><dt>อารมณ์ (ระบุ):</dt><dd data-field="Self_Mood_Detail"></dd></div>
            <div><dt>กระทบความสามารถ:</dt><dd data-field="Self_Ability"></dd></div>
            <div class="md:col-span-2"><dt>ความสามารถ (ระบุ):</dt><dd data-field="Self_Ability_Detail"></dd></div>
          </div>
        </fieldset>

        <!-- 8. การเผชิญภาวะเครียด -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">8. การเผชิญภาวะเครียด</legend>
          <div class="preview-grid mt-2">
            <div><dt>สิ่งไม่สบายใจ:</dt><dd data-field="Cope_Stress_Status"></dd></div>
            <div class="col-span-full"><dt>รายละเอียด (Checkbox):</dt><dd id="preview-cope-stress-details"></dd></div>
            <div class="col-span-full"><dt>รายละเอียด (อื่นๆ):</dt><dd data-field="Cope_Stress_Other_Text"></dd></div>
            <div><dt>การแสดงออก:</dt><dd data-field="Cope_Expression"></dd></div>
            <div class="md:col-span-2"><dt>แสดงออก (อื่นๆ):</dt><dd data-field="Cope_Expression_Other"></dd></div>
            <div><dt>วิธีแก้ไข:</dt><dd data-field="Cope_Method"></dd></div>
            <div class="md:col-span-2"><dt>วิธีแก้ไข (อื่นๆ):</dt><dd data-field="Cope_Method_Other"></dd></div>
          </div>
        </fieldset>

        <!-- 9. บทบาท -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">9. บทบาทและสัมพันธภาพ</legend>
          <div class="preview-grid preview-grid-4 mt-2">
            <div><dt>กระทบครอบครัว:</dt><dd data-field="Role_Effect_Family"></dd></div>
            <div><dt>กระทบอาชีพ:</dt><dd data-field="Role_Effect_Career"></dd></div>
            <div><dt>กระทบการศึกษา:</dt><dd data-field="Role_Effect_Education"></dd></div>
            <div><dt>กระทบสัมพันธภาพ:</dt><dd data-field="Role_Effect_Relationship"></dd></div>
          </div>
        </fieldset>

        <!-- 10. เพศ -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">10. เพศและการเจริญพันธุ์</legend>
          <div class="preview-grid mt-2">
            <div><dt>ประจำเดือน:</dt><dd data-field="Sex_Menses"></dd></div>
            <div><dt>สถานะประจำเดือน:</dt><dd data-field="Sex_Menses_Status"></dd></div>
            <div><dt>เต้านม:</dt><dd data-field="Sex_Breast"></dd></div>
            <div><dt>อวัยวะสืบพันธ์:</dt><dd data-field="Sex_Genital"></dd></div>
          </div>
        </fieldset>
        
        <!-- 11. ความเชื่อ -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">11. คุณค่าและความเชื่อ</legend>
          <div class="preview-grid mt-2">
            <div><dt>สาเหตุที่ป่วย:</dt><dd data-field="Belief_Cause"></dd></div>
            <div class="md:col-span-2"><dt>สาเหตุ (อื่นๆ):</dt><dd data-field="Belief_Cause_Other"></dd></div>
            <div><dt>กิจทางศาสนา:</dt><dd data-field="Belief_Ritual"></dd></div>
            <div class="md:col-span-2"><dt>กิจ (ระบุ):</dt><dd data-field="Belief_Ritual_Detail"></dd></div>
            <div><dt>สิ่งยึดเหนี่ยว:</dt><dd data-field="Belief_Anchor"></dd></div>
            <div class="md:col-span-2"><dt>สิ่งยึดเหนี่ยว (ระบุ):</dt><dd data-field="Belief_Anchor_Detail"></dd></div>
          </div>
        </fieldset>
        
        <!-- 12. การมีส่วนร่วม -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">12. การมีส่วนร่วม</legend>
          <div class="preview-grid mt-2">
            <div><dt>สถานะ:</dt><dd data-field="Partic_Status"></dd></div>
            <div class="col-span-full"><dt>ไม่ต้องการ (เนื่องจาก):</dt><dd data-field="Partic_No_Detail"></dd></div>
            <div class="col-span-full"><dt>ต้องการ (Checkbox):</dt><dd id="preview-partic-details"></dd></div>
            <div class="col-span-full"><dt>ต้องการ (อื่นๆ):</dt><dd data-field="Partic_Want_Other"></dd></div>
          </div>
        </fieldset>

        <!-- 13. Pain -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">13. PAIN MANAGEMENT</legend>
          <div class="preview-grid mt-2">
            <div><dt>สถานะปวด:</dt><dd data-field="Pain_Status"></dd></div>
            <div class="md:col-span-2"><dt>บริเวณ:</dt><dd data-field="Pain_Location"></dd></div>
            <div><dt>สาเหตุ:</dt><dd data-field="Pain_Cause"></dd></div>
            <div><dt>ลักษณะ:</dt><dd data-field="Pain_Pattern"></dd></div>
            <div class="md:col-span-2"><dt>ลักษณะ (อื่นๆ):</dt><dd data-field="Pain_Pattern_Other"></dd></div>
            <div><dt>Scale (Numeric):</dt><dd data-field="Pain_Scale_Score"></dd></div>
            <div class="md:col-span-2"><dt>Scale (Face):</dt><dd data-field="Pain_Scale_Face"></dd></div>
            <div class="col-span-full"><dt>กระทบต่อ:</dt><dd id="preview-pain-effect"></dd></div>
            <div class="col-span-full"><dt>สิ่งที่บรรเทา:</dt><dd id="preview-pain-relief"></dd></div>
          </div>
        </fieldset>
        
        <!-- 14. Braden -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">14. Braden Scale</legend>
          <div class="preview-grid mt-2">
            <div><dt>การรับรู้:</dt><dd data-field="Braden_Sensory"></dd></div>
            <div><dt>ความเปียกชื้น:</dt><dd data-field="Braden_Moisture"></dd></div>
            <div><dt>กิจกรรม:</dt><dd data-field="Braden_Activity"></dd></div>
            <div><dt>การเคลื่อนไหว:</dt><dd data-field="Braden_Mobility"></dd></div>
            <div><dt>โภชนาการ:</dt><dd data-field="Braden_Nutrition"></dd></div>
            <div><dt>การเสียดสี:</dt><dd data-field="Braden_Friction"></dd></div>
            <div class="md:col-span-2"><dt>คะแนนรวม (Total):</dt><dd data-field="Braden_Total" class="font-bold text-blue-700"></dd></div>
            <div><dt>แปลผล:</dt><dd data-field="Braden_Result"></dd></div>
          </div>
        </fieldset>

        <!-- 15. Fall Risk -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">15. Fall risk assessment</legend>
          <div class="preview-grid preview-grid-4 mt-2">
            <div><dt>วัยเด็ก:</dt><dd data-field="Fall_Age_Child"></dd></div>
            <div><dt>ผู้สูงอายุ >65:</dt><dd data-field="Fall_Age_Elder"></dd></div>
            <div><dt>สภาวะทางจิต:</dt><dd data-field="Fall_Mental"></dd></div>
            <div><dt>ประวัติหกล้ม:</dt><dd data-field="Fall_History"></dd></div>
            <div><dt>ใช้ยา:</dt><dd data-field="Fall_Meds"></dd></div>
            <div><dt>การมองเห็น:</dt><dd data-field="Fall_Vision"></dd></div>
            <div><dt>การเดิน/ทรงตัว:</dt><dd data-field="Fall_Gait"></dd></div>
            <div><dt>ผลลัพธ์:</dt><dd data-field="Fall_Result"></dd></div>
          </div>
        </fieldset>
        
        <!-- ผู้ประเมิน -->
        <fieldset class="border p-4 rounded-lg">
          <legend class="text-lg font-semibold px-2">ผู้ประเมิน</legend>
          <div class="preview-grid mt-2">
            <div class="md:col-span-2"><dt>ชื่อผู้ประเมิน:</dt><dd data-field="Assessor_Name"></dd></div>
            <div><dt>ตำแหน่ง:</dt><dd data-field="Assessor_Position"></dd></div>
            <div class="col-span-full"><dt>อัปเดตล่าสุด:</dt><dd data-field="LastUpdatedTime" id="preview-last-updated-time"></dd></div>
            <div class="col-span-full"><dt>อัปเดตโดย:</dt><dd data-field="LastUpdatedBy"></dd></div>
          </div>
        </fieldset>
      </div>
    </template>
  
  <!-- (Template 005) -->
  <template id="preview-template-005">
    <div class="overflow-x-auto">
      <table class="w-full min-w-max">
        <thead class="bg-gray-100 text-sm text-gray-700">
          <tr>
            <th class="p-2 border text-center w-12">ลำดับ</th>
            <th class="p-2 border text-left">ปัญหา (FOCUS / PROBLEM)</th>
            <th class="p-2 border text-left">เป้าหมาย (Goal/Outcome)</th>
            <th class="p-2 border text-center w-28">วันที่พบ</th>
            <th class="p-2 border text-center w-28">วันที่สิ้นสุด</th>
            <th class="p-2 border text-center w-20">แก้ไข</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <!-- (JS จะเติมรายการปัญหาที่นี่) -->
        </tbody>
      </table>
    </div>
  </template>

  <!-- ============================================= -->
  <!-- (5) MODALS (Pop-ups) -->
  <!-- ============================================= -->

  <!-- ============================================= -->
  <!-- (5) MODALS (Pop-ups) -->
  <!-- ============================================= -->

  <!-- (Modal: Admit) -->
  <div id="admit-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-16 z-50 hidden overflow-y-auto">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[85vh] m-4">
      <div class="flex justify-between items-center p-4 border-b">
        <h3 class="text-xl font-semibold text-gray-800">บันทึกรับใหม่ (Admit Patient)</h3>
        <button id="close-admit-modal-btn" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
      </div>
      
      <form id="admit-form" class="p-6 overflow-y-auto max-h-[calc(85vh-130px)]">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="col-span-1">
            <label for="admit-date" class="block text-sm font-medium text-gray-700">วันที่รับ</label>
            <input type="date" id="admit-date" name="AdmitDate" class="mt-1 p-2 block w-full border rounded-md" required>
          </div>
          <div class="col-span-1">
            <label for="admit-time" class="block text-sm font-medium text-gray-700">เวลารับ</label>
            <input type="time" id="admit-time" name="AdmitTime" class="mt-1 p-2 block w-full border rounded-md" required>
          </div>
          <div class="col-span-1">
            <label for="admit-from" class="block text-sm font-medium text-gray-700">รับจาก</label>
            <select id="admit-from" name="AdmittedFrom" class="mt-1 p-2 block w-full border rounded-md" required>
              </select>
          </div>
          
          <div class="col-span-2">
            <label for="admit-refer" class="block text-sm font-medium text-gray-700">Refer (ถ้ามี)</label>
            <input type="text" id="admit-refer" name="Refer" class="mt-1 p-2 block w-full border rounded-md">
          </div>
          <div class="col-span-1">
            <label for="admit-bed" class="block text-sm font-medium text-gray-700">รับเข้าเตียง</label>
            <select id="admit-bed" name="Bed" class="mt-1 p-2 block w-full border rounded-md" required>
              <option value="">-- เลือกเตียงว่าง --</option>
              </select>
          </div>

          <hr class="md:col-span-3 my-2">

          <div class="col-span-1">
            <label for="admit-hn" class="block text-sm font-medium text-gray-700">HN</label>
            <input type="text" id="admit-hn" name="HN" class="mt-1 p-2 block w-full border rounded-md" required>
          </div>
          <div class="col-span-1">
            <label for="admit-an" class="block text-sm font-medium text-gray-700">AN (คีย์หลัก)</label>
            <input type="text" id="admit-an" name="AN" class="mt-1 p-2 block w-full border rounded-md" required>
          </div>
          <div class="col-span-1">
            <label for="admit-name" class="block text-sm font-medium text-gray-700">ชื่อ-สกุล</label>
            <input type="text" id="admit-name" name="Name" class="mt-1 p-2 block w-full border rounded-md" required>
          </div>

          <div class="md:col-span-3">
             <label for="admit-address" class="block text-sm font-medium text-gray-700">ที่อยู่</label>
            <textarea id="admit-address" name="Address" rows="2" class="mt-1 p-2 block w-full border rounded-md"></textarea>
          </div>

          <div class="col-span-1">
            <label for="admit-dob" class="block text-sm font-medium text-gray-700">วันเกิด (ค.ศ.)</label>
            <input type="date" id="admit-dob" name="DOB_BE" class="mt-1 p-2 block w-full border rounded-md" required>
          </div>
          <div class="col-span-1">
            <label for="admit-age" class="block text-sm font-medium text-gray-700">อายุ</label>
            <input type="text" id="admit-age" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
          </div>
           <div class="col-span-1">
            <label for="admit-dept" class="block text-sm font-medium text-gray-700">แผนก</label>
            <select id="admit-dept" name="Dept" class="mt-1 p-2 block w-full border rounded-md" required>
               </select>
          </div>
          
          <hr class="md:col-span-3 my-2">

          <div class="md:col-span-3">
             <label for="admit-cc" class="block text-sm font-medium text-gray-700">อาการสำคัญ (CC)</label>
            <textarea id="admit-cc" name="ChiefComplaint" rows="2" class="mt-1 p-2 block w-full border rounded-md"></textarea>
          </div>
           <div class="md:col-span-3">
             <label for="admit-pi" class="block text-sm font-medium text-gray-700">ประวัติการเจ็บป่วย (PI)</label>
            <textarea id="admit-pi" name="PresentIllness" rows="3" class="mt-1 p-2 block w-full border rounded-md"></textarea>
          </div>

          <div class="col-span-2">
            <label for="admit-dx" class="block text-sm font-medium text-gray-700">การวินิจฉัยแรกรับ (Admitting Dx)</label>
            <input type="text" id="admit-dx" name="AdmittingDx" class="mt-1 p-2 block w-full border rounded-md">
          </div>
          <div class="col-span-1">
            <label for="admit-doctor" class="block text-sm font-medium text-gray-700">แพทย์เจ้าของไข้</label>
            <select id="admit-doctor" name="Doctor" class="mt-1 p-2 block w-full border rounded-md" required>
               </select>
          </div>

        </div>
      </form>
      
      <div class="flex justify-end items-center p-4 border-t bg-gray-50 rounded-b-lg">
        <button id="cancel-admit-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg mr-3">
          ยกเลิก
        </button>
        <button type="submit" form="admit-form" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow">
          บันทึกข้อมูล
        </button>
      </div>
    </div>
  </div>

  <!-- (Modal: Details) -->
  <div id="details-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-16 z-50 hidden overflow-y-auto">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[85vh] m-4">
      <div class="flex justify-between items-center p-4 border-b">
        <h3 class="text-xl font-semibold text-gray-800">รายละเอียดผู้ป่วย</h3>
        <button id="close-details-modal-btn" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
      </div>
      
      <fieldset id="details-fieldset" disabled>
        <form id="details-form" class="p-6 overflow-y-auto max-h-[calc(85vh-200px)]">
          
          <input type="hidden" id="details-an" name="AN">
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">วันที่รับ</label>
              <input type="date" id="details-date" name="AdmitDate" class="mt-1 p-2 block w-full border rounded-md bg-gray-100">
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">เวลารับ</label>
              <input type="time" id="details-time" name="AdmitTime" class="mt-1 p-2 block w-full border rounded-md bg-gray-100">
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">รับจาก</label>
              <select id="details-from" name="AdmittedFrom" class="mt-1 p-2 block w-full border rounded-md">
                </select>
            </div>
            
            <div class="col-span-2">
              <label class="block text-sm font-medium text-gray-700">Refer</label>
              <input type="text" id="details-refer" name="Refer" class="mt-1 p-2 block w-full border rounded-md">
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">เตียง</label>
              <input type="text" id="details-bed-display" class="mt-1 p-2 block w-full border rounded-md bg-gray-100">
              <select id="details-bed-select" name="Bed" class="mt-1 p-2 block w-full border rounded-md hidden">
                </select>
            </div>

            <hr class="md:col-span-3 my-2">

            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">HN</label>
              <input type="text" id="details-hn" name="HN" class="mt-1 p-2 block w-full border rounded-md bg-gray-100">
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">AN</label>
              <input type="text" id="details-an-display" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">ชื่อ-สกุล</label>
              <input type="text" id="details-name" name="Name" class="mt-1 p-2 block w-full border rounded-md">
            </div>

            <div class="md:col-span-3">
               <label class="block text-sm font-medium text-gray-700">ที่อยู่</label>
              <textarea id="details-address" name="Address" rows="2" class="mt-1 p-2 block w-full border rounded-md"></textarea>
            </div>

            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">วันเกิด (ค.ศ.)</label>
              <input type="date" id="details-dob" name="DOB_CE" class="mt-1 p-2 block w-full border rounded-md">
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">อายุ</label>
              <input type="text" id="details-age" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
            </div>
             <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">แผนก</label>
              <select id="details-dept" name="Dept" class="mt-1 p-2 block w-full border rounded-md">
                 </select>
            </div>
            
            <hr class="md:col-span-3 my-2">

            <div class="md:col-span-3">
               <label class="block text-sm font-medium text-gray-700">อาการสำคัญ (CC)</label>
              <textarea id="details-cc" name="ChiefComplaint" rows="2" class="mt-1 p-2 block w-full border rounded-md"></textarea>
            </div>
             <div class="md:col-span-3">
               <label class="block text-sm font-medium text-gray-700">ประวัติการเจ็บป่วย (PI)</label>
              <textarea id="details-pi" name="PresentIllness" rows="3" class="mt-1 p-2 block w-full border rounded-md"></textarea>
            </div>

            <div class="col-span-2">
              <label class="block text-sm font-medium text-gray-700">การวินิจฉัยแรกรับ (Admitting Dx)</label>
              <input type="text" id="details-dx" name="AdmittingDx" class="mt-1 p-2 block w-full border rounded-md">
            </div>
            <div class="col-span-1">
              <label class="block text-sm font-medium text-gray-700">แพทย์เจ้าของไข้</label>
              <select id="details-doctor" name="Doctor" class="mt-1 p-2 block w-full border rounded-md">
                 </select>
            </div>

          </div>
        </form>
      </fieldset>
      
      <div class="flex justify-between items-center p-4 border-t bg-gray-50 rounded-b-lg">
        <div>
          <button id="transfer-ward-btn" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg mr-2 hidden">
            ย้ายตึก
          </button>
          <button id="discharge-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg hidden">
            จำหน่าย (Discharge)
          </button>
        </div>
      
        <div>
          <button id="edit-patient-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">
             แก้ไขข้อมูล
          </button>
          <button id="save-details-btn" type="submit" form="details-form" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg hidden">
            บันทึกการแก้ไข
          </button>
          <button id="cancel-edit-btn" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg ml-2 hidden">
            ยกเลิก
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- (Modal: Assessment FR-IPD-004) -->
  <div id="assessment-modal" class="fixed inset-0 bg-white z-50 hidden overflow-y-auto">
    <form id="assessment-form">
      <!-- Modal Header (Sticky) -->
      <div class="sticky top-0 bg-white shadow-md z-10">
        <div class="container mx-auto px-6 py-4 flex flex-col md:flex-row justify-between md:items-center">
          <div>
            <h3 class="text-2xl font-bold text-indigo-800">แบบประเมินประวัติและสมรรถนะผู้ป่วย (FR-IPD-004)</h3>
            <p class="text-gray-600">AN: <strong id="assess-an-display" class="text-indigo-700"></strong> | ชื่อ: <strong id="assess-name-display" class="text-indigo-700"></strong></p>
          </div>
          <div class="mt-3 md:mt-0">
            <button id="close-assessment-modal-btn" type="button" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg mr-3">
              ปิด
            </button>
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow">
              บันทึกข้อมูล
            </button>
          </div>
        </div>
      </div>
      
      <!-- Modal Body (Scrollable) -->
      <div class="container mx-auto px-6 py-8">
        <div class="space-y-8">

          <!-- ===== ข้อมูลทั่วไป ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-xl font-semibold px-2 text-gray-800">ข้อมูลทั่วไป (ดึงจากข้อมูลรับใหม่)</legend>
            <div class="grid grid-cols-12 gap-4 mt-4">
              <!-- (ดึงข้อมูลมา) -->
              <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">วันที่รับ</label>
                <input type="date" id="assess-admit-date" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
              </div>
              <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">เวลารับ</label>
                <input type="time" id="assess-admit-time" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
              </div>
              <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">รับจาก</label>
                <input type="text" id="assess-admit-from" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
              </div>
               <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">Refer จาก</label>
                <input type="text" id="assess-refer-from" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
              </div>
              
              <!-- (ข้อมูลใหม่) -->
              <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">มาโดย</label>
                <select name="ArriveBy" class="mt-1 p-2 block w-full border rounded-md">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="เดินมา">เดินมา</option>
                  <option value="รถนั่ง">รถนั่ง</option>
                  <option value="เปลนอน">เปลนอน</option>
                </select>
              </div>
              <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">ผู้ให้ข้อมูล</label>
                <select name="InfoSource" class="mt-1 p-2 block w-full border rounded-md">
                   <option value="">-- กรุณาเลือก --</option>
                  <option value="ผู้ป่วย">ผู้ป่วย</option>
                  <option value="ผู้นำส่ง/ญาติ">ผู้นำส่ง/ญาติ</option>
                </select>
              </div>
              <div class="col-span-12 md:col-span-6">
                <label class="block text-sm font-medium text-gray-700">ผู้ดูแลหลักชื่อ</label>
                <input type="text" name="MainCaregiver_Name" class="mt-1 p-2 block w-full border rounded-md">
              </div>
              <div class="col-span-12 md:col-span-6">
                <label class="block text-sm font-medium text-gray-700">ความสัมพันธ์กับผู้ป่วย</label>
                <div class="mt-2 space-y-2 md:space-y-0 md:flex md:flex-wrap md:gap-x-6">
                  <label class="flex items-center"><input type="radio" name="MainCaregiver_Rel" value="บิดา-มารดา" class="mr-2 assessment-radio-toggle">บิดา-มารดา</label>
                  <label class="flex items-center"><input type="radio" name="MainCaregiver_Rel" value="สามี,ภรรยา,บุตร" class="mr-2 assessment-radio-toggle">สามี,ภรรยา,บุตร</label>
                  <label class="flex items-center"><input type="radio" name="MainCaregiver_Rel" value="ญาติ" class="mr-2 assessment-radio-toggle">ญาติ</label>
                  <label class="flex items-center"><input type="radio" name="MainCaregiver_Rel" value="อื่นๆ" class="mr-2 assessment-radio-toggle" data-controls="rel-other">อื่นๆ:</label>
                </div>
                <input type="text" name="MainCaregiver_Rel_Other_Text" id="rel-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ระบุ...">
              </div>

              <div class="col-span-12">
                <label class="block text-sm font-medium text-gray-700">อาการสำคัญ (CC)</label>
                <textarea id="assess-cc" name="ChiefComplaint" rows="2" class="mt-1 p-2 block w-full border rounded-md"></textarea>
              </div>
              <div class="col-span-12">
                <label class="block text-sm font-medium text-gray-700">ประวัติการเจ็บป่วยปัจจุบัน (PI)</label>
                <textarea id="assess-pi" name="PresentIllness" rows="3" class="mt-1 p-2 block w-full border rounded-md"></textarea>
              </div>
              <div class="col-span-12">
                <label class="block text-sm font-medium text-gray-700">อาการและอาการแสดงแรกรับ</label>
                <textarea name="AdmitSymptoms" rows="2" class="mt-1 p-2 block w-full border rounded-md"></textarea>
              </div>

              <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">BT (ฐC)</label>
                <input type="text" name="Admit_BT" class="mt-1 p-2 block w-full border rounded-md">
              </div>
               <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">PR (ครั้ง/min)</label>
                <input type="text" name="Admit_PR" class="mt-1 p-2 block w-full border rounded-md">
              </div>
               <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">RR (ครั้ง/min)</label>
                <input type="text" name="Admit_RR" class="mt-1 p-2 block w-full border rounded-md">
              </div>
               <div class="col-span-12 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">BP (mmHg)</label>
                <input type="text" name="Admit_BP" class="mt-1 p-2 block w-full border rounded-md">
              </div>
            </div>
          </fieldset>
          
          <!-- ===== ประวัติ (Hx) ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">ประวัติการเจ็บป่วย (History)</legend>
            <div class="space-y-6 mt-4">
              
              <!-- โรคประจำตัว -->
              <div>
                <label class="block text-sm font-medium text-gray-700">โรคประจำตัว</label>
                <div class="flex flex-wrap gap-x-6 gap-y-2 mt-2">
                  <label class="flex items-center"><input type="radio" name="Hx_Status" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Hx_Status" value="ไม่ทราบ" class="mr-2 assessment-radio-toggle">ไม่ทราบ</label>
                  <label class="flex items-center"><input type="radio" name="Hx_Status" value="ไม่เคยตรวจ" class="mr-2 assessment-radio-toggle">ไม่เคยตรวจ</label>
                  <label class="flex items-center"><input type="radio" name="Hx_Status" value="มี" class="mr-2 assessment-radio-toggle" data-controls="hx-details">มี (ระบุด้านล่าง)</label>
                </div>
                <div id="hx-details" class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 border-l-4 pl-4 hidden">
                  <label class="flex items-center"><input type="checkbox" name="Hx_HT" value="true" class="mr-2">ความดันโลหิตสูง</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_Heart" value="true" class="mr-2">โรคหัวใจ</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_Liver" value="true" class="mr-2">โรคตับ</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_Kidney" value="true" class="mr-2">โรคไต</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_DM" value="true" class="mr-2">เบาหวาน</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_Asthma" value="true" class="mr-2">หอบหืด</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_Epilepsy" value="true" class="mr-2">ลมชัก</label>
                  <label class="flex items-center"><input type="checkbox" name="Hx_TB" value="true" class="mr-2">วัณโรค</label>
                  <div class="col-span-2 flex"><label class="flex items-center"><input type="checkbox" name="Hx_Cancer" value="true" class="mr-2">มะเร็ง ระบุ:</label><input type="text" name="Hx_Cancer_Detail" class="ml-2 p-1 border rounded-md flex-grow"></div>
                  <div class="col-span-2 flex"><label class="flex items-center">อื่นๆ ระบุ:</label><input type="text" name="Hx_Other" class="ml-2 p-1 border rounded-md flex-grow"></div>
                </div>
              </div>
              
              <!-- การแพ้ยา -->
              <div>
                <label class="block text-sm font-medium text-gray-700">การแพ้ยา/สารต่างๆ</label>
                <div class="flex flex-wrap gap-x-6 gap-y-2 mt-2">
                  <label class="flex items-center"><input type="radio" name="Allergy_Status" value="ไม่เคย" class="mr-2 assessment-radio-toggle">ไม่เคย</label>
                  <label class="flex items-center"><input type="radio" name="Allergy_Status" value="เคย" class="mr-2 assessment-radio-toggle" data-controls="allergy-details">เคย</label>
                  <input type="text" name="Allergy_Details" id="allergy-details" class="ml-2 p-1 border rounded-md flex-grow hidden" placeholder="ระบุชนิด, อาการ, การแก้ไข...">
                </div>
              </div>
              
              <!-- การผ่าตัด -->
              <div>
                <label class="block text-sm font-medium text-gray-700">การผ่าตัด</label>
                <div class="flex flex-wrap gap-x-6 gap-y-2 mt-2">
                  <label class="flex items-center"><input type="radio" name="Sx_Status" value="ไม่เคย" class="mr-2 assessment-radio-toggle">ไม่เคย</label>
                  <label class="flex items-center"><input type="radio" name="Sx_Status" value="เคย" class="mr-2 assessment-radio-toggle" data-controls="sx-details">เคย</label>
                  <input type="text" name="Sx_Details" id="sx-details" class="ml-2 p-1 border rounded-md flex-grow hidden" placeholder="ผ่าตัด...">
                  <input type="text" name="Sx_Date" class="ml-2 p-1 border rounded-md hidden" placeholder="เมื่อ..." data-follows="sx-details">
                </div>
              </div>
              
              <!-- การรักษาตัวใน รพ. -->
              <div>
                <label class="block text-sm font-medium text-gray-700">การรักษาตัวในโรงพยาบาล</label>
                <div class="flex flex-wrap gap-x-6 gap-y-2 mt-2">
                  <label class="flex items-center"><input type="radio" name="AdmitHx_Status" value="ไม่เคย" class="mr-2 assessment-radio-toggle">ไม่เคย</label>
                  <label class="flex items-center"><input type="radio" name="AdmitHx_Status" value="เคย" class="mr-2 assessment-radio-toggle" data-controls="admit-hx-details">เคย</label>
                  <input type="text" name="AdmitHx_Disease" id="admit-hx-details" class="ml-2 p-1 border rounded-md flex-grow hidden" placeholder="ด้วยโรค...">
                  <input type="text" name="AdmitHx_Date" class="ml-2 p-1 border rounded-md hidden" placeholder="เมื่อ..." data-follows="admit-hx-details">
                </div>
              </div>
              
              <!-- ประวัติครอบครัว -->
              <div>
                <label class="block text-sm font-medium text-gray-700">ประวัติการเจ็บป่วยในครอบครัว</label>
                <div class="flex flex-wrap gap-x-6 gap-y-2 mt-2">
                  <label class="flex items-center"><input type="radio" name="FamilyHx_Status" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="FamilyHx_Status" value="มี" class="mr-2 assessment-radio-toggle" data-controls="family-hx-details">มี</label>
                  <input type="text" name="FamilyHx_Details" id="family-hx-details" class="ml-2 p-1 border rounded-md flex-grow hidden" placeholder="ระบุ...">
                </div>
              </div>
              
              <!-- สิ่งเสพติด -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700">สุรา</label>
                  <select name="Substance_Alcohol" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="alcohol-vol">
                    <option value="">-- กรุณาเลือก --</option>
                    <option value="ไม่ดื่ม">ไม่ดื่ม</option>
                    <option value="ดื่มนาน ๆ ครั้ง">ดื่มนาน ๆ ครั้ง</option>
                    <option value="ดื่มเป็นประจำ">ดื่มเป็นประจำ</option>
                  </select>
                  <input type="text" name="Substance_Alcohol_Vol" id="alcohol-vol" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ปริมาณ...ต่อวัน">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700">บุหรี่</label>
                  <select name="Substance_Smoke" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="smoke-vol">
                    <option value="">-- กรุณาเลือก --</option>
                    <option value="ไม่สูบ">ไม่สูบ</option>
                    <option value="สูบนาน ๆ ครั้ง">สูบนาน ๆ ครั้ง</option>
                    <option value="สูบเป็นประจำ">สูบเป็นประจำ</option>
                  </select>
                  <input type="text" name="Substance_Smoke_Vol" id="smoke-vol" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ปริมาณ...ต่อวัน">
                </div>
              </div>
              
              <!-- ยาที่ใช้ประจำ -->
              <div>
                <label class="block text-sm font-medium text-gray-700">ยาที่ใช้ประจำ</label>
                <div class="flex items-center gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Meds_Status" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Meds_Status" value="มี" class="mr-2 assessment-radio-toggle" data-controls="meds-details">มี</label>
                </div>
                <textarea name="Meds_Details" id="meds-details" rows="2" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ระบุ (ตาม Med Reconcile หรือ อื่นๆ)"></textarea>
              </div>
            </div>
          </fieldset>

          <!-- ===== 1. การรับรู้เกี่ยวกับสุขภาพและการดูแล ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">1. การรับรู้เกี่ยวกับสุขภาพและการดูแล</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">ก่อนการเจ็บป่วยครั้งนี้</label>
                <select name="HP_Before" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="hp-before-detail">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ดี">ดี</option>
                  <option value="ไม่ดี">ไม่ดี</option>
                </select>
                <input type="text" name="HP_Before_Detail" id="hp-before-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ไม่ดี ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">เจ็บป่วยครั้งนี้</label>
                <select name="HP_Current" class="mt-1 p-2 block w-full border rounded-md">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="รุนแรง">รุนแรง</option>
                  <option value="ไม่รุนแรง">ไม่รุนแรง</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การดูแล</label>
                <select name="HP_Care" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="hp-care-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ไปรพ./ คลินิก">ไปรพ./ คลินิก</option>
                  <option value="ซื้อยารับประทาน">ซื้อยารับประทาน</option>
                  <option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="HP_Care_Other" id="hp-care-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ความคาดหวังในการรักษาครั้งนี้</label>
                <select name="HP_Expect" class="mt-1 p-2 block w-full border rounded-md">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="หาย">หาย</option>
                  <option value="ไม่แน่ใจ">ไม่แน่ใจ</option>
                  <option value="ไม่หาย">ไม่หาย</option>
                </select>
              </div>
            </div>
          </fieldset>

          <!-- ===== 2. โภชนาการและการเผาผลาญ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">2. โภชนาการและการเผาผลาญ</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">รับประทานอาหาร</label>
                <div class="flex items-center gap-2">
                  <input type="text" name="Nutri_Meals" class="mt-1 p-2 w-1/4 border rounded-md" placeholder="...มื้อ/วัน">
                  <select name="Nutri_Type" class="mt-1 p-2 flex-grow border rounded-md assessment-radio-toggle" data-controls="nutri-type-detail">
                    <option value="">-- กรุณาเลือก --</option>
                    <option value="อาหารธรรมดา">อาหารธรรมดา</option>
                    <option value="อาหารอ่อน">อาหารอ่อน</option>
                    <option value="อาหารทางสายยาง">อาหารทางสายยาง</option>
                    <option value="อาหารเฉพาะโรค">อาหารเฉพาะโรค</option>
                  </select>
                </div>
                <input type="text" name="Nutri_Type_Detail" id="nutri-type-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อาหารเฉพาะโรค ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ปัญหาในการรับประทานอาหาร</label>
                <div class="flex gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Nutri_Problem" value="ไม่มี" class="mr-2">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Nutri_Problem" value="มี" class="mr-2">มี</label>
                </div>
              </div>
              <div class="col-span-1 md:col-span-2">
                <label class="block text-sm font-medium text-gray-700">ผิวหนัง</label>
                <div class="flex gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Nutri_Skin" value="ปกติ" class="mr-2 assessment-radio-toggle">ปกติ</label>
                  <label class="flex items-center"><input type="radio" name="Nutri_Skin" value="ไม่ปกติ" class="mr-2 assessment-radio-toggle" data-controls="nutri-skin-detail">ไม่ปกติ</label>
                </div>
                <input type="text" name="Nutri_Skin_Detail" id="nutri-skin-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ไม่ปกติ ระบุ...">
              </div>
            </div>
          </fieldset>

          <!-- ===== 3. การขับถ่าย ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">3. การขับถ่าย</legend>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">ถ่ายปัสสาวะ</label>
                <input type="text" name="Elim_Urine_Freq" class="mt-1 p-2 block w-full border rounded-md" placeholder="...ครั้ง/วัน">
                <select name="Elim_Urine_Status" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="elim-urine-detail">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปกติ">ปกติ</option>
                  <option value="ไม่ปกติ">ไม่ปกติ</option>
                </select>
                <input type="text" name="Elim_Urine_Detail" id="elim-urine-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ไม่ปกติ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ถ่ายอุจจาระ</label>
                <input type="text" name="Elim_Bowel_Freq" class="mt-1 p-2 block w-full border rounded-md" placeholder="...ครั้ง/วัน">
                <select name="Elim_Bowel_Status" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="elim-bowel-detail">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปกติ">ปกติ</option>
                  <option value="ไม่ปกติ">ไม่ปกติ</option>
                </select>
                <input type="text" name="Elim_Bowel_Detail" id="elim-bowel-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ไม่ปกติ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การขับถ่ายทางหน้าท้อง</label>
                <div class="flex gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Elim_Stoma" value="ไม่มี" class="mr-2">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Elim_Stoma" value="มี" class="mr-2">มี</label>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- ===== 4. กิจวัตรประจำวัน (ADL) ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">4. กิจวัตรประจำวัน (ADL)</legend>
            <div class="overflow-x-auto mt-4">
              <table class="w-full min-w-[700px] border-collapse">
                <thead>
                  <tr class="bg-gray-100">
                    <th rowspan="2" class="p-2 border text-left text-sm font-semibold text-gray-700">กิจกรรม</th>
                    <th colspan="4" class="p-2 border text-center text-sm font-semibold text-gray-700">ก่อนการเจ็บป่วย</th>
                    <th colspan="4" class="p-2 border text-center text-sm font-semibold text-gray-700">ขณะเจ็บป่วย</th>
                  </tr>
                  <tr class="bg-gray-50">
                    <th class="p-1 border text-xs font-medium text-gray-600">ทำได้เอง</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">บางส่วน</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">ไม่ได้เลย</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">ใช้อุปกรณ์</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">ทำได้เอง</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">บางส่วน</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">ไม่ได้เลย</th>
                    <th class="p-1 border text-xs font-medium text-gray-600">ใช้อุปกรณ์</th>
                  </tr>
                </thead>
                <tbody class="divide-y">
                  <!-- (สร้าง 1 แถวต่อ 1 ADL, ใช้ Radio Button) -->
                  <tr>
                    <td class="p-2 border">1. การรับประทานอาหาร</td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Before" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Before" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Before" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Before" value="ใช้อุปกรณ์"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Current" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Current" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Current" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Eat_Current" value="ใช้อุปกรณ์"></td>
                  </tr>
                  <tr>
                    <td class="p-2 border">2. การทำความสะอาดปากและฟัน</td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Before" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Before" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Before" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Before" value="ใช้อุปกรณ์"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Current" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Current" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Current" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Brush_Current" value="ใช้อุปกรณ์"></td>
                  </tr>
                  <tr>
                    <td class="p-2 border">3. การแต่งตัว</td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Before" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Before" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Before" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Before" value="ใช้อุปกรณ์"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Current" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Current" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Current" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Dress_Current" value="ใช้อุปกรณ์"></td>
                  </tr>
                  <tr>
                    <td class="p-2 border">4. การเดิน</td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Before" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Before" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Before" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Before" value="ใช้อุปกรณ์"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Current" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Current" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Current" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Walk_Current" value="ใช้อุปกรณ์"></td>
                  </tr>
                  <tr>
                    <td class="p-2 border">5. การขับถ่าย</td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Before" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Before" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Before" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Before" value="ใช้อุปกรณ์"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Current" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Current" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Current" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Toilet_Current" value="ใช้อุปกรณ์"></td>
                  </tr>
                  <tr>
                    <td class="p-2 border">6. การอาบน้ำ</td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Before" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Before" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Before" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Before" value="ใช้อุปกรณ์"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Current" value="ทำได้เอง"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Current" value="บางส่วน"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Current" value="ไม่ได้เลย"></td>
                    <td class="p-2 border text-center"><input type="radio" name="ADL_Bath_Current" value="ใช้อุปกรณ์"></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </fieldset>
          
          <!-- ===== 5. การพักผ่อนนอนหลับ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">5. การพักผ่อนนอนหลับ</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">นอน</label>
                <input type="text" name="Sleep_Hours" class="mt-1 p-2 block w-full border rounded-md" placeholder="...ชั่วโมง/วัน">
                <div class="flex gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Sleep_Adequacy" value="เพียงพอ" class="mr-2">เพียงพอ</label>
                  <label class="flex items-center"><input type="radio" name="Sleep_Adequacy" value="ไม่เพียงพอ" class="mr-2">ไม่เพียงพอ</label>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ปัญหาการนอน</label>
                <div class="flex gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Sleep_Problem" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Sleep_Problem" value="มี" class="mr-2 assessment-radio-toggle" data-controls="sleep-problem-detail">มี</label>
                </div>
                <input type="text" name="Sleep_Problem_Detail" id="sleep-problem-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="มี ระบุ...">
              </div>
            </div>
          </fieldset>
          
          <!-- ===== 6. การรับรู้และประสาทสัมผัส ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">6. การรับรู้และประสาทสัมผัส</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">ระดับความรู้สึก</label>
                <select name="Cogn_LOC" class="mt-1 p-2 block w-full border rounded-md">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="รู้สึกตัวดี">รู้สึกตัวดี</option><option value="สับสน">สับสน</option><option value="ไม่รู้สึกตัว">ไม่รู้สึกตัว</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การมองเห็น</label>
                <select name="Cogn_Vision" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="cogn-vision-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปกติ">ปกติ</option><option value="สายตาสั้น">สายตาสั้น</option><option value="สายตายาว">สายตายาว</option><option value="ใช้แว่นตา">ใช้แว่นตา</option><option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="Cogn_Vision_Other" id="cogn-vision-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การได้ยิน</label>
                <select name="Cogn_Hearing" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="cogn-hearing-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปกติ">ปกติ</option><option value="ได้ยินบางส่วน">ได้ยินบางส่วน</option><option value="ไม่ได้ยิน">ไม่ได้ยิน</option><option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="Cogn_Hearing_Other" id="cogn-hearing-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การพูด</label>
                <select name="Cogn_Speech" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="cogn-speech-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปกติ">ปกติ</option><option value="มีปัญหา">มีปัญหา</option><option value="ใช้ภาษาต่างประเทศ">ใช้ภาษาต่างประเทศ</option>
                </select>
                <input type="text" name="Cogn_Speech_Other" id="cogn-speech-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ภาษาต่างประเทศ ระบุ...">
              </div>
              <div class="col-span-1 md:col-span-2">
                <label class="block text-sm font-medium text-gray-700">การเคลื่อนไหว</label>
                <select name="Cogn_Movement" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="cogn-movement-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปกติ">ปกติ</option><option value="ข้อติดแข้ง">ข้อติดแข้ง</option><option value="ข้ออักเสบ">ข้ออักเสบ</option><option value="อัมพาต">อัมพาต</option><option value="กระดูกหัก">กระดูกหัก</option><option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="Cogn_Movement_Other" id="cogn-movement-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
            </div>
          </fieldset>

          <!-- ===== 7. การรับรู้ตนเองและอัตมโนทัศน์ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">7. การรับรู้ตนเองและอัตมโนทัศน์</legend>
            <p class="text-sm text-gray-600">การเจ็บป่วยมีผลกระทบต่อ:</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">ภาพลักษณ์</label>
                <select name="Self_Image" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="self-image-detail">
                  <option value="">-- กรุณาเลือก --</option><option value="ไม่มี">ไม่มี</option><option value="ไม่แน่ใจ">ไม่แน่ใจ</option><option value="มี">มี</option></select>
                <input type="text" name="Self_Image_Detail" id="self-image-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="มี ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">อารมณ์และจิตใจ</label>
                <select name="Self_Mood" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="self-mood-detail">
                  <option value="">-- กรุณาเลือก --</option><option value="ไม่มี">ไม่มี</option><option value="ไม่แน่ใจ">ไม่แน่ใจ</option><option value="มี">มี</option></select>
                <input type="text" name="Self_Mood_Detail" id="self-mood-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="มี ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ความสามารถในการดูแลตนเอง</label>
                <select name="Self_Ability" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="self-ability-detail">
                  <option value="">-- กรุณาเลือก --</option><option value="ไม่มี">ไม่มี</option><option value="ไม่แน่ใจ">ไม่แน่ใจ</option><option value="มี">มี</option></select>
                <input type="text" name="Self_Ability_Detail" id="self-ability-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="มี ระบุ...">
              </div>
            </div>
          </fieldset>
          
          <!-- ===== 8. การเผชิญภาวะเครียด / การปรับตัว ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">8. การเผชิญภาวะเครียด / การปรับตัว</legend>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
              <div class="col-span-1 md:col-span-3">
                <label class="block text-sm font-medium text-gray-700">สิ่งที่ทำให้ไม่สบายใจ</label>
                <div class="flex gap-x-6 mt-2">
                  <label class="flex items-center"><input type="radio" name="Cope_Stress_Status" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Cope_Stress_Status" value="มี" class="mr-2 assessment-radio-toggle" data-controls="cope-stress-details">มี (ระบุด้านล่าง)</label>
                </div>
                <div id="cope-stress-details" class="mt-2 border-l-4 pl-4 space-y-2 hidden">
                  <label class="flex items-center"><input type="checkbox" name="Cope_Stress_Fear" value="true" class="mr-2">กลัวไม่หาย</label>
                  <label class="flex items-center"><input type="checkbox" name="Cope_Stress_Cost" value="true" class="mr-2">ค่ารักษาพยาบาล</label>
                  <label class="flex items-center"><input type="checkbox" name="Cope_Stress_Work" value="true" class="mr-2">ขาดงาน/รายได้</label>
                  <label class="flex items-center"><input type="checkbox" name="Cope_Stress_Family" value="true" class="mr-2">ครอบครัว</label>
                  <div class="flex"><label class="flex items-center">อื่นๆ:</label><input type="text" name="Cope_Stress_Other_Text" class="ml-2 p-1 border rounded-md flex-grow"></div>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การแสดงออก</label>
                <select name="Cope_Expression" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="cope-expression-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="สีหน้าเรียบเฉย">สีหน้าเรียบเฉย</option><option value="วิตกกังวล">วิตกกังวล</option><option value="กลัว">กลัว</option><option value="ซึมเศร้า">ซึมเศร้า</option><option value="เอะอะโวยวาย">เอะอะโวยวาย</option><option value="หงุดหงิด">หงุดหงิด</option><option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="Cope_Expression_Other" id="cope-expression-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">วิธีการแก้ไขความไม่สบายใจ</label>
                <select name="Cope_Method" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="cope-method-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="ปรึกษาผู้อื่น">ปรึกษาผู้อื่น</option><option value="แยกตัวเอง">แยกตัวเอง</option><option value="ใช้ยา">ใช้ยา</option><option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="Cope_Method_Other" id="cope-method-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
            </div>
          </fieldset>
          
          <!-- ===== 9. บทบาทและสัมพันธภาพ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">9. บทบาทและสัมพันธภาพ</legend>
            <p class="text-sm text-gray-600">การเจ็บป่วยครั้งนี้มีผลกระทบต่อ:</p>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <label class="flex items-center"><input type="checkbox" name="Role_Effect_Family" value="true" class="mr-2">ครอบครัว</label>
              <label class="flex items-center"><input type="checkbox" name="Role_Effect_Career" value="true" class="mr-2">อาชีพ</label>
              <label class="flex items-center"><input type="checkbox" name="Role_Effect_Education" value="true" class="mr-2">การศึกษา</label>
              <label class="flex items-center"><input type="checkbox" name="Role_Effect_Relationship" value="true" class="mr-2">สัมพันธภาพ</label>
            </div>
          </fieldset>

          <!-- ===== 10. เพศและการเจริญพันธุ์ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">10. เพศและการเจริญพันธุ์</legend>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">ประจำเดือน</label>
                <div class="flex gap-x-4 mt-1">
                  <label class="flex items-center"><input type="radio" name="Sex_Menses" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Sex_Menses" value="มี" class="mr-2 assessment-radio-toggle" data-controls="menses-status">มี</label>
                </div>
                <div id="menses-status" class="flex gap-x-4 mt-1 border-l-4 pl-4 hidden">
                  <label class="flex items-center"><input type="radio" name="Sex_Menses_Status" value="ปกติ" class="mr-2">ปกติ</label>
                  <label class="flex items-center"><input type="radio" name="Sex_Menses_Status" value="ไม่ปกติ" class="mr-2">ไม่ปกติ</label>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">เต้านม</label>
                <div class="flex gap-x-6 mt-1">
                  <label class="flex items-center"><input type="radio" name="Sex_Breast" value="ปกติ" class="mr-2">ปกติ</label>
                  <label class="flex items-center"><input type="radio" name="Sex_Breast" value="ไม่ปกติ" class="mr-2">ไม่ปกติ</label>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">อวัยวะสืบพันธ์</label>
                <div class="flex gap-x-6 mt-1">
                  <label class="flex items-center"><input type="radio" name="Sex_Genital" value="ปกติ" class="mr-2">ปกติ</label>
                  <label class="flex items-center"><input type="radio" name="Sex_Genital" value="ไม่ปกติ" class="mr-2">ไม่ปกติ</label>
                </div>
              </div>
            </div>
          </fieldset>
          
          <!-- ===== 11. คุณค่าและความเชื่อ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">11. คุณค่าและความเชื่อ</legend>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">การเจ็บป่วยครั้งนี้เชื่อว่า</label>
                <select name="Belief_Cause" class="mt-1 p-2 block w-full border rounded-md assessment-radio-toggle" data-controls="belief-cause-other">
                  <option value="">-- กรุณาเลือก --</option>
                  <option value="การปฏิบัติตัวไม่ถูกต้อง">การปฏิบัติตัวไม่ถูกต้อง</option>
                  <option value="เคราะห์กรรม">เคราะห์กรรม</option>
                  <option value="อื่นๆ">อื่นๆ</option>
                </select>
                <input type="text" name="Belief_Cause_Other" id="belief-cause-other" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="อื่นๆ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ต้องการปฏิบัติกิจทางศาสนา</label>
                <div class="flex gap-x-6 mt-1">
                  <label class="flex items-center"><input type="radio" name="Belief_Ritual" value="ไม่ต้องการ" class="mr-2 assessment-radio-toggle">ไม่ต้องการ</label>
                  <label class="flex items-center"><input type="radio" name="Belief_Ritual" value="ต้องการ" class="mr-2 assessment-radio-toggle" data-controls="belief-ritual-detail">ต้องการ</label>
                </div>
                <input type="text" name="Belief_Ritual_Detail" id="belief-ritual-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ต้องการ ระบุ...">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">สิ่งยึดเหนี่ยวทางจิตใจ</label>
                <div class="flex gap-x-6 mt-1">
                  <label class="flex items-center"><input type="radio" name="Belief_Anchor" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
                  <label class="flex items-center"><input type="radio" name="Belief_Anchor" value="มี" class="mr-2 assessment-radio-toggle" data-controls="belief-anchor-detail">มี</label>
                </div>
                <input type="text" name="Belief_Anchor_Detail" id="belief-anchor-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="มี ระบุ...">
              </div>
            </div>
          </fieldset>
          
          <!-- ===== 12. การมีส่วนร่วมของผู้ป่วยและญาติ ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">12. การมีส่วนร่วมของผู้ป่วยและญาติ</legend>
            <div class="flex gap-x-6 mt-4">
              <label class="flex items-center"><input type="radio" name="Partic_Status" value="ไม่ต้องการ" class="mr-2 assessment-radio-toggle" data-controls="partic-no-detail">ไม่ต้องการ</label>
              <label class="flex items-center"><input type="radio" name="Partic_Status" value="ต้องการ" class="mr-2 assessment-radio-toggle" data-controls="partic-want-details">ต้องการ</label>
            </div>
            <input type="text" name="Partic_No_Detail" id="partic-no-detail" class="mt-1 p-2 block w-full border rounded-md hidden" placeholder="ไม่ต้องการ เนื่องจาก...">
            <div id="partic-want-details" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 border-l-4 pl-4 hidden">
              <label class="flex items-center"><input type="checkbox" name="Partic_Want_Info" value="true" class="mr-2">ทราบข้อมูลโรคและแนวทางการรักษา</label>
              <label class="flex items-center"><input type="checkbox" name="Partic_Want_Skill" value="true" class="mr-2">เรียนรู้ทักษะการดูแลตนเอง / ผู้ป่วย</label>
              <label class="flex items-center"><input type="checkbox" name="Partic_Want_Join" value="true" class="mr-2">ร่วมกับทีมสุขภาพในการดูแล</label>
              <input type="text" name="Partic_Want_Other" class="mt-1 p-2 block w-full border rounded-md" placeholder="อื่นๆ ระบุ...">
            </div>
          </fieldset>

          <!-- ===== 13. PAIN MANAGEMENT ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">13. PAIN MANAGEMENT</legend>
            <div class="flex gap-x-6 mt-4">
              <label class="flex items-center"><input type="radio" name="Pain_Status" value="ไม่มี" class="mr-2 assessment-radio-toggle">ไม่มี</label>
              <label class="flex items-center"><input type="radio" name="Pain_Status" value="มี" class="mr-2 assessment-radio-toggle" data-controls="pain-details">มี</label>
            </div>
            <div id="pain-details" class="space-y-6 mt-4 border-l-4 pl-4 hidden">
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <input type="text" name="Pain_Location" class="p-2 border rounded-md" placeholder="บริเวณที่ปวด">
                <input type="text" name="Pain_Cause" class="p-2 border rounded-md" placeholder="สาเหตุ">
                <div class="flex">
                  <select name="Pain_Pattern" class="p-2 border rounded-l-md assessment-radio-toggle" data-controls="pain-pattern-other">
                    <option value="">-- กรุณาเลือก --</option>
                    <option value="เป็นครั้งคราว">เป็นครั้งคราว</option><option value="ตลอดเวลา">ตลอดเวลา</option><option value="อื่นๆ">อื่นๆ</option>
                  </select>
                  <input type="text" name="Pain_Pattern_Other" id="pain-pattern-other" class="p-2 border rounded-r-md flex-grow hidden" placeholder="อื่นๆ ระบุ...">
                </div>
              </div>
              
              <!-- Pain Scale (Numeric) -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mt-4">Pain Scale (0-10)</label>
                <div class="flex flex-wrap gap-2 mt-2">
                  <script>
                    for (let i = 0; i <= 10; i++) {
                      let bgColor = 'bg-gray-200 hover:bg-gray-300';
                      if (i === 0) bgColor = 'bg-blue-300 hover:bg-blue-400';
                      if (i >= 1 && i <= 3) bgColor = 'bg-green-300 hover:bg-green-400';
                      if (i >= 4 && i <= 6) bgColor = 'bg-yellow-300 hover:bg-yellow-400';
                      if (i >= 7 && i <= 9) bgColor = 'bg-orange-400 hover:bg-orange-500';
                      if (i === 10) bgColor = 'bg-red-500 hover:bg-red-600';
                      
                      document.write(`
                        <label class="cursor-pointer">
                          <input type="radio" name="Pain_Scale_Score" value="${i}" class="sr-only peer">
                          <div class="w-10 h-10 flex items-center justify-center rounded-full ${bgColor} peer-checked:ring-4 peer-checked:ring-offset-2 peer-checked:ring-blue-600 transition-all">
                            <span class="text-lg font-bold text-gray-800">${i}</span>
                          </div>
                        </label>
                      `);
                    }
                  </script>
                </div>
              </div>
              
              <!-- Pain Scale (Faces) -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mt-4">Pain Scale (จากสีหน้า)</label>
                <div class="flex flex-wrap gap-4 mt-2">
                  <label class="cursor-pointer text-center">
                    <input type="radio" name="Pain_Scale_Face" value="No Pain" class="sr-only peer">
                    <div class="p-2 rounded-lg border border-gray-200 peer-checked:bg-blue-100 peer-checked:border-blue-500">
                      <span class="text-4xl">😊</span>
                      <p class="text-xs">No Pain</p>
                    </div>
                  </label>
                  <label class="cursor-pointer text-center">
                    <input type="radio" name="Pain_Scale_Face" value="Mild" class="sr-only peer">
                    <div class="p-2 rounded-lg border border-gray-200 peer-checked:bg-green-100 peer-checked:border-green-500">
                      <span class="text-4xl">🙂</span>
                      <p class="text-xs">Mild</p>
                    </div>
                  </label>
                  <label class="cursor-pointer text-center">
                    <input type="radio" name="Pain_Scale_Face" value="Discomforting" class="sr-only peer">
                    <div class="p-2 rounded-lg border border-gray-200 peer-checked:bg-green-100 peer-checked:border-green-500">
                      <span class="text-4xl">😐</span>
                      <p class="text-xs">Discomforting</p>
                    </div>
                  </label>
                  <label class="cursor-pointer text-center">
                    <input type="radio" name="Pain_Scale_Face" value="Distressing" class="sr-only peer">
                    <div class="p-2 rounded-lg border border-gray-200 peer-checked:bg-yellow-100 peer-checked:border-yellow-500">
                      <span class="text-4xl">😟</span>
                      <p class="text-xs">Distressing</p>
                    </div>
                  </label>
                  <label class="cursor-pointer text-center">
                    <input type="radio" name="Pain_Scale_Face" value="Intense" class="sr-only peer">
                    <div class="p-2 rounded-lg border border-gray-200 peer-checked:bg-orange-100 peer-checked:border-orange-500">
                      <span class="text-4xl">😫</span>
                      <p class="text-xs">Intense</p>
                    </div>
                  </label>
                  <label class="cursor-pointer text-center">
                    <input type="radio" name="Pain_Scale_Face" value="Horrible" class="sr-only peer">
                    <div class="p-2 rounded-lg border border-gray-200 peer-checked:bg-red-100 peer-checked:border-red-500">
                      <span class="text-4xl">😭</span>
                      <p class="text-xs">Horrible</p>
                    </div>
                  </label>
                </div>
              </div>
              
              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700">การปวดกระทบต่อ:</label>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mt-2">
                  <label class="flex items-center"><input type="checkbox" name="Pain_Effect_Eat" value="true" class="mr-2">การกิน</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Effect_Sleep" value="true" class="mr-2">การนอน</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Effect_Activity" value="true" class="mr-2">การทำกิจกรรม</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Effect_Mood" value="true" class="mr-2">อารมณ์/สังคม</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Effect_Elim" value="true" class="mr-2">การขับถ่าย</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Effect_Sex" value="true" class="mr-2">เพศสัมพันธ์</label>
                </div>
              </div>
              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700">สิ่งที่บรรเทาปวด:</label>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-2">
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Cold" value="true" class="mr-2">Cold compress</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Hot" value="true" class="mr-2">Hot compress</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Massage" value="true" class="mr-2">Massage</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Relax" value="true" class="mr-2">Relaxation</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Repo" value="true" class="mr-2">Reposition</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Rest" value="true" class="mr-2">Rest/Sleep</label>
                  <label class="flex items-center"><input type="checkbox" name="Pain_Relief_Meds" value="true" class="mr-2">Medication</label>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- ===== 14. Braden Scale ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">14. Braden Scale for Predicting Pressure Sore Risk</legend>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">การรับรู้ /ความรู้สึก</label>
                <select name="Braden_Sensory" class="mt-1 p-2 block w-full border rounded-md braden-score">
                  <option value="4">4 - ไม่บกพร่อง</option>
                  <option value="3">3 - มีความจำกัดเล็กน้อย</option>
                  <option value="2">2 - มีความจำกัดมาก</option>
                  <option value="1">1 - มีความจำกัดทั้งหมด</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ความเปียกชื้น</label>
                <select name="Braden_Moisture" class="mt-1 p-2 block w-full border rounded-md braden-score">
                  <option value="4">4 - เปียกชื้นน้อยมาก</option>
                  <option value="3">3 - เปียกชื้นเป็นบางครั้ง</option>
                  <option value="2">2 - เปียกชื้นมาก</option>
                  <option value="1">1 - เปียกชื้นตลอดเวลา</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">กิจกรรม</label>
                <select name="Braden_Activity" class="mt-1 p-2 block w-full border rounded-md braden-score">
                  <option value="4">4 - เดินได้บ่อยๆ</option>
                  <option value="3">3 - เดินได้เป็นบางครั้ง</option>
                  <option value="2">2 - เดินไม่ได้ต้องนั่งเก้าอี้</option>
                  <option value="1">1 - นอนอยู่กับที่ตลอดเวลา</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การเคลื่อนไหว</label>
                <select name="Braden_Mobility" class="mt-1 p-2 block w-full border rounded-md braden-score">
                  <option value="4">4 - เคลื่อนไหวได้ปกติ</option>
                  <option value="3">3 - เคลื่อนไหวเองได้บ้าง</option>
                  <option value="2">2 - เคลื่อนไหวเองได้น้อย</option>
                  <option value="1">1 - เคลื่อนไหวเองไม่ได้</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">โภชนาการ</label>
                <select name="Braden_Nutrition" class="mt-1 p-2 block w-full border rounded-md braden-score">
                  <option value="4">4 - ดีเยี่ยม</option>
                  <option value="3">3 - เพียงพอ</option>
                  <option value="2">2 - อาจไม่เพียงพอ</option>
                  <option value="1">1 - ไม่เพียงพอ</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">การเสียดสีและการเลียดทาน</label>
                <select name="Braden_Friction" class="mt-1 p-2 block w-full border rounded-md braden-score">
                   <option value="3">3 - ไม่มีปัญหา</option>
                   <option value="2">2 - เสี่ยงต่อการเกิดปัญหา</option>
                   <option value="1">1 - มีปัญหา</option>
                </select>
              </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6">
              <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700">Total Score</label>
                <input type="text" id="braden-total-score" name="Braden_Total" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
              </div>
              <div class="md:col-span-1 flex items-end">
                <p class="text-sm text-gray-600">แปลผล: <span id="braden-result" class="font-semibold text-lg text-blue-700"></span></p>
              </div>
            </div>
          </fieldset>
          
          <!-- ===== 15. Fall risk assessment ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm">
            <legend class="text-lg font-semibold px-2 text-gray-800">15. Fall risk assessment</legend>
            <div class="space-y-4 mt-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <label class="flex items-center"><input type="checkbox" name="Fall_Age_Child" value="true" class="mr-2">วัยเด็ก</label>
                <label class="flex items-center"><input type="checkbox" name="Fall_Age_Elder" value="true" class="mr-2">ผู้สูงอายุมากกว่า 65 ปี</label>
              </div>
              <label class="flex items-center"><input type="checkbox" name="Fall_Mental" value="true" class="mr-2">สภาวะทางสมอง/ทางจิตผิดปกติ</label>
              <label class="flex items-center"><input type="checkbox" name="Fall_History" value="true" class="mr-2">มีประวัติพลัดตกหกล้ม/ชัก</label>
              <label class="flex items-center"><input type="checkbox" name="Fall_Meds" value="true" class="mr-2">ใช้ยานอนหลับ / psychotropics / Sedative</label>
              <label class="flex items-center"><input type="checkbox" name="Fall_Vision" value="true" class="mr-2">มีปัญหาในการมองเห็น</label>
              <label class="flex items-center"><input type="checkbox" name="Fall_Gait" value="true" class="mr-2">มีปัญหาในการเดิน/ทรงตัว</label>
            </div>
            <div class="mt-6">
              <label class="block text-sm font-medium text-gray-700">จำเป็นต้องได้รับการป้องกัน</label>
              <div class="flex gap-x-6 mt-2">
                <label class="flex items-center"><input type="radio" name="Fall_Result" value="จำเป็น" class="mr-2">จำเป็น</label>
                <label class="flex items-center"><input type="radio" name="Fall_Result" value="ไม่จำเป็น" class="mr-2">ไม่จำเป็น</label>
              </div>
            </div>
          </fieldset>

          <!-- ===== ผู้ประเมิน ===== -->
          <fieldset class="border p-4 rounded-lg shadow-sm bg-gray-50">
            <legend class="text-lg font-semibold px-2 text-gray-800">ผู้ประเมิน</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
              <div>
                <label class="block text-sm font-medium text-gray-700">ลงชื่อผู้ประเมิน</label>
                <select id="assessor-name" name="Assessor_Name" class="mt-1 p-2 block w-full border rounded-md">
                  <option value="">-- กรุณาเลือก --</option>
                  <!-- (จะถูกเติมโดย script.js) -->
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700">ตำแหน่ง</label>
                <input type="text" id="assessor-position" name="Assessor_Position" class="mt-1 p-2 block w-full border rounded-md bg-gray-200" readonly>
              </div>
            </div>
          </fieldset>

        </div>
        
        <!-- Footer ใน Form -->
        <div class="mt-12 pt-6 border-t flex justify-end">
            <button id="close-assessment-modal-btn-bottom" type="button" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg mr-3">
              ปิด
            </button>
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow">
              บันทึกข้อมูล
            </button>
        </div>

      </div>
    </form>
  </div>

  <!-- (Modal: Classification) -->
  <div id="classify-modal" class="fixed inset-0 bg-white z-50 hidden overflow-y-auto">
    <form id="classify-form">
      <!-- Modal Header (Sticky) -->
      <div class="sticky top-0 bg-white shadow-md z-10">
        <div class="container mx-auto px-6 py-4">
          <div class="flex flex-col md:flex-row justify-between md:items-center">
            <div>
              <h3 class="text-2xl font-bold text-teal-800">แบบบันทึกการจำแนกประเภทผู้ป่วย</h3>
              <p class="text-gray-600">AN: <strong id="classify-an-display" class="text-teal-700"></strong> | ชื่อ: <strong id="classify-name-display" class="text-teal-700"></strong></p>
            </div>
            <div class="mt-3 md:mt-0 flex items-center space-x-3">
              <!-- Paging Control -->
              <div class="flex items-center space-x-2">
                <button id="classify-prev-page-btn" type="button" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md">&lt;</button>
                <span class="text-lg font-semibold">หน้า <span id="classify-page-display">1</span></span>
                <button id="classify-next-page-btn" type="button" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md">&gt;</button>
                <button id="classify-add-page-btn" type="button" class="px-3 py-2 bg-green-500 text-white hover:bg-green-600 rounded-md">+</button>
              </div>
              <button id="close-classify-modal-btn" type="button" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg">
                ปิด
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Modal Body (Scrollable Table) -->
      <div class="container mx-auto px-6 py-8">
        <div class="overflow-x-auto">
          <table id="classify-table" class="w-full min-w-[1200px] border-collapse">
            <thead>
              <!-- (ส่วนหัวตารางจะถูกสร้างโดย JS) -->
            </thead>
            <tbody id="classify-table-body">
              <!-- (8 หมวดประเมิน + สรุป จะถูกสร้างโดย JS) -->
            </tbody>
          </table>
        </div>
       </div>
    </form>
  </div>

  <!-- (Modal: Focus Problem FR-IPD-005) -->
  <div id="focus-problem-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-start pt-16 z-50 hidden overflow-y-auto">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[85vh] m-4">
      <form id="focus-problem-form">
        <div class="flex justify-between items-center p-4 border-b">
          <h3 id="focus-modal-title" class="text-xl font-semibold text-gray-800">เพิ่มรายการปัญหาสุขภาพ</h3>
          <button id="close-focus-modal-btn" type="button" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
        </div>
        
        <input type="hidden" id="focus-entry-id" name="Entry_ID">
        
        <div class="p-6 overflow-y-auto max-h-[calc(85vh-200px)] space-y-6">
          
          <fieldset class="border p-4 rounded-lg">
            <legend class="text-lg font-semibold px-2">ปัญหา (FOCUS / PROBLEM)</legend>
            <div class="mt-2">
              <label for="focus-template-problem" class="block text-sm font-medium text-gray-700">เลือกจากเทมเพลต (ถ้ามี)</label>
              <div class="flex items-center space-x-2">
                <select id="focus-template-problem" class="mt-1 p-2 block w-full border rounded-md bg-gray-50">
                  <option value="">-- เลือกเทมเพลตปัญหา --</option>
                </select>
                <button type="button" id="open-template-modal-btn" class="mt-1 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 font-bold" title="เพิ่มเทมเพลตใหม่">+</button>
              </div>
              <label for="focus-problem-text" class="block text-sm font-medium text-gray-700 mt-4">พิมพ์/แก้ไข ปัญหา</label>
              <textarea id="focus-problem-text" name="Problem" rows="4" class="mt-1 p-2 block w-full border rounded-md" required></textarea>
            </div>
          </fieldset>

          <fieldset class="border p-4 rounded-lg">
            <legend class="text-lg font-semibold px-2">เป้าหมาย (Goal/Outcome)</legend>
            <div class="mt-2">
              <label for="focus-template-goal" class="block text-sm font-medium text-gray-700">เลือกจากเทมเพลต (ถ้ามี)</label>
              <select id="focus-template-goal" class="mt-1 p-2 block w-full border rounded-md bg-gray-50">
                <option value="">-- เลือกเทมเพลตเป้าหมาย --</option>
              </select>
              <label for="focus-goal-text" class="block text-sm font-medium text-gray-700 mt-4">พิมพ์/แก้ไข เป้าหมาย</label>
              <textarea id="focus-goal-text" name="Goal" rows="4" class="mt-1 p-2 block w-full border rounded-md"></textarea>
            </div>
          </fieldset>
          
          <fieldset class="border p-4 rounded-lg">
            <legend class="text-lg font-semibold px-2">วันที่</legend>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
              <div>
                <label for="focus-active-date" class="block text-sm font-medium text-gray-700">วันที่พบปัญหา (Active)</label>
                <input type="date" id="focus-active-date" name="ActiveDate" class="mt-1 p-2 block w-full border rounded-md" required>
              </div>
              <div>
                <label for="focus-resolved-date" class="block text-sm font-medium text-gray-700">วันที่สิ้นสุดปัญหา (Resolved)</label>
                <input type="date" id="focus-resolved-date" name="ResolvedDate" class="mt-1 p-2 block w-full border rounded-md">
              </div>
            </div>
          </fieldset>

        </div>
        
        <div class="flex justify-end items-center p-4 border-t bg-gray-50 rounded-b-lg">
          <button id="cancel-focus-btn" type="button" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg mr-3">
            ยกเลิก
          </button>
          <button type="submit" form="focus-problem-form" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow">
            บันทึกปัญหา
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- (Modal: Add Template FR-IPD-005) -->
  <div id="add-template-modal" class="fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-60 hidden">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-lg m-4">
      <form id="add-template-form">
        <div class="flex justify-between items-center p-4 border-b">
          <h3 class="text-xl font-semibold text-gray-800">สร้างเทมเพลตปัญหาใหม่ (FR-IPD-005)</h3>
          <button id="close-template-modal-btn" type="button" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button>
        </div>
        
        <div class="p-6 space-y-4">
          <div>
            <label for="template-problem-text" class="block text-sm font-medium text-gray-700">ปัญหา (Problem)</label>
            <textarea id="template-problem-text" name="Problem" rows="3" class="mt-1 p-2 block w-full border rounded-md" required placeholder="เช่น: เสี่ยงต่อการพลัดตกหกล้ม"></textarea>
          </div>
          <div>
            <label for="template-goal-text" class="block text-sm font-medium text-gray-700">เป้าหมายที่คู่กัน (Goal)</label>
            <textarea id="template-goal-text" name="Goal" rows="3" class="mt-1 p-2 block w-full border rounded-md" placeholder="เช่น: ไม่เกิดการพลัดตกหกล้มตลอดระยะเวลาที่อยู่ รพ."></textarea>
          </div>
        </div>
        
        <div class="flex justify-end items-center p-4 border-t bg-gray-50 rounded-b-lg">
          <button id="cancel-template-modal-btn" type="button" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg mr-3">
            ยกเลิก
          </button>
          <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow">
            บันทึกเทมเพลต
          </button>
        </div>
      </form>
    </div>
  </div>

</main> <!-- (ย้าย </main> มาไว้ตรงนี้) -->

<script src="script.js"></script>
</body>
</html>
